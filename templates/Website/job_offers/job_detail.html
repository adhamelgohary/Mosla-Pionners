{% extends "Website/base.html" %}

{% block title %}{{ offer.Title if offer else 'Job Offer Details' }} - Mosla Pioneers{% endblock %}

{% block content %}
<div class="job-detail-page-wrapper">
    <main class="relative z-10 max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12">
        <div class="bg-card/90 backdrop-blur-sm p-6 sm:p-8 lg:p-10 rounded-2xl shadow-xl border border-border/50">
            {% if offer %}
                <!-- Job Header -->
                <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4 sm:gap-6 pb-6 mb-6 border-b border-border">
                    {% if offer.CompanyLogoURL %}
                        <img src="{{ url_for('static', filename=offer.CompanyLogoURL) }}" alt="{{ offer.CompanyName }} Logo" class="w-16 h-16 sm:w-20 sm:h-20 object-contain rounded-xl bg-white p-1 flex-shrink-0 border border-border">
                    {% endif %}
                    <div>
                        <h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-heading">{{ offer.Title }}</h1>
                        <p class="mt-1 text-lg font-medium text-primary">{{ offer.CompanyName }}</p>
                    </div>
                </div>

                <!-- Job Meta Details Grid -->
                <div class="grid grid-cols-2 lg:grid-cols-3 gap-y-6 gap-x-6 mb-8 text-sm">
                    <div class="flex items-center gap-3"><svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" /></svg> <span class="text-text-muted">{{ offer.Location }}</span></div>
                    <div class="flex items-center gap-3"><svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21" /></svg> <span class="text-text-muted">{{ offer.WorkLocationType }}</span></div>
                    <div class="flex items-center gap-3"><svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.826-1.106-2.255 0-3.081a2.5 2.5 0 014.242 0l.879.659" /></svg> <span class="text-text-muted">{{ 'Up to ' ~ offer.NetSalary|int if offer.NetSalary else 'Not Disclosed' }} EGP / {{ offer.PaymentTerm }}</span></div>
                    <div class="flex items-center gap-3"><svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z" /><path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z" /></svg> <span class="text-text-muted">{{ offer.CategoryName }}</span></div>
                    <div class="flex items-center gap-3"><svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg> <span class="text-text-muted">{{ offer.RequiredLevel }} English</span></div>
                    <div class="flex items-center gap-3"><svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m.75 12l3 3m0 0l3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg> <span class="text-text-muted">{{ offer.InterviewType }} Interview</span></div>
                </div>

                <div class="prose prose-lg max-w-none dark:prose-invert prose-headings:text-heading prose-a:text-primary prose-strong:text-text">
                    
                    <!-- Key Qualifications -->
                    <h3>Key Qualifications</h3>
                    <ul>
                        <li><strong>Language Proficiency:</strong> {{ offer.LanguagesType }} candidate with a required level of <strong>{{ offer.RequiredLevel }}</strong>. Languages: {{ offer.RequiredLanguages_list|join(', ') if offer.RequiredLanguages_list else 'Not Specified' }}.</li>
                        <li><strong>Graduation Status:</strong> {{ offer.GraduationStatusRequirement }}.</li>
                        <li><strong>Nationality:</strong> Open to {{ offer.Nationality }}.</li>
                        {% if offer.MaxAge %}<li><strong>Age Requirement:</strong> Maximum age of {{ offer.MaxAge }} years.</li>{% endif %}
                    </ul>

                    <!-- Offer Conditions & Shifts -->
                    <h3>Offer Conditions</h3>
                    <ul>
                        <li><strong>Contract:</strong> This position {% if offer.HasContract %}<strong>includes a formal contract</strong>{% else %}does not include a formal contract{% endif %}.</li>
                        <li><strong>Shift Type:</strong> {{ offer.ShiftType }} shifts.
                        {% if offer.ShiftType == 'Fixed' and offer.AvailableShifts_list %}
                            (Available shifts: {{ offer.AvailableShifts_list|join(', ') }})
                        {% endif %}
                        </li>
                    </ul>

                    <!-- Benefits -->
                    {% if offer.BenefitsIncluded_list %}
                        <h3>Benefits & Perks</h3>
                        <ul>
                            {% for benefit in offer.BenefitsIncluded_list %}
                                <li>{{ benefit }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}

                    <!-- About Company -->
                    {% if offer.CompanyDescription %}
                        <h3>About {{ offer.CompanyName }}</h3>
                        <p>{{ offer.CompanyDescription|safe }}</p>
                    {% endif %}
                </div>
                
                <div class="mt-10 text-center">
                    <a href="{{ url_for('job_board_bp.job_offers_list') }}" class="text-sm font-semibold text-primary hover:text-primary-darker">← Back to All Job Offers</a>
                </div>
            {% else %}
                 <div class="text-center py-10">
                    <h2 class="text-xl font-bold text-heading">Job Offer Not Found</h2>
                    <p class="mt-2 text-text-muted">This offer may no longer be available.</p>
                    <a href="{{ url_for('job_board_bp.job_offers_list') }}" class="mt-6 inline-block rounded-md bg-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-darker">← View Other Job Offers</a>
                </div>
            {% endif %}
        </div>
    </main>
</div>

<!-- Sticky Apply Bar -->
<div class="fixed bottom-0 left-0 w-full bg-gray-900/90 backdrop-blur-lg border-t border-white/10 shadow-2xl z-50">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex flex-col sm:flex-row items-center justify-between gap-4 py-3">
            <div class="text-center sm:text-left">
                <h4 class="font-bold text-white text-base sm:text-lg">{{ offer.Title }}</h4>
                <p class="text-sm text-gray-300">{{ offer.CompanyName }} • {{ offer.Location }}</p>
            </div>
            <div class="flex-shrink-0 w-full sm:w-auto">
                {% if current_user.is_authenticated and current_user.role_type == 'Candidate' %}
                    <a href="{{ url_for('job_board_bp.apply_to_job', offer_id=offer.OfferID) }}" class="block w-full text-center rounded-lg bg-primary px-6 py-3 text-base font-semibold text-white shadow-sm hover:bg-primary-darker focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary">Apply Now</a>
                {% else %}
                    <a href="{{ url_for('login_bp.login', next=url_for('job_board_bp.apply_to_job', offer_id=offer.OfferID)) }}" class="block w-full text-center rounded-lg bg-primary px-6 py-3 text-base font-semibold text-white shadow-sm hover:bg-primary-darker">Login to Apply</a>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block page_scripts %}
{{ super() }}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const stickyBar = document.querySelector('.fixed.bottom-0');
        const mainContent = document.querySelector('main');
        function updateContentPadding() {
            if (stickyBar && mainContent) {
                const barHeight = stickyBar.offsetHeight;
                mainContent.style.paddingBottom = (barHeight + 40) + 'px';
            }
        }
        updateContentPadding();
        window.addEventListener('resize', updateContentPadding);
    });
</script>
{% endblock %}

{# Remove footer from this specific page #}
{% block footer %}{% endblock footer %}