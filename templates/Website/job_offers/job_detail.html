{% extends "Website/base.html" %}

{% block title %}{{ offer.Title if offer else 'Job Offer Details' }} - Mosla Pioneers{% endblock %}

{% block head_extra %}
    {{ super() }}
    {# Link to your custom CSS if it's not already in base.html #}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/offer_styles.css') }}">
{% endblock %}

{% block content %}
<div class="job-offer-page-container">
    <div class="offer-details">
        {% if offer %}
            <!-- Job Header -->
            <div class="job-card-header">
                {% if offer.CompanyLogoURL %}
                    <img src="{{ url_for('static', filename=offer.CompanyLogoURL) }}" alt="{{ offer.CompanyName }} Logo" class="company-logo">
                {% endif %}
                <div>
                    <h1>{{ offer.Title }}</h1>
                    <p class="company-name-display">{{ offer.CompanyName }}</p>
                </div>
            </div>

            <!-- Job Meta Details Grid -->
            <div class="details-grid">
                {% if offer.Location %}
                <div class="detail-item">
                    <svg viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9.69 18.933l.003.001C9.89 19.02 10 19 10 19s.11.02.308-.066l.002-.001.006-.003.018-.008a5.741 5.741 0 00.281-.14c.186-.1.4-.27.6-.5s.4-.5.5-.868c.1-.368.1-.9.1-1.469V10.5a3 3 0 00-3-3V3.375C5.25 3.375 3 5.625 3 8.375v1.369a5.741 5.741 0 00.281.14c.186.1.4-.27.6.5s.4.5.5.868c.1.368.1.9.1-1.469V8.375a3 3 0 013-3v3.125c.75 0 1.5.25 2.125.625A2.982 2.982 0 0115 10.5v2.639c0 .57.005 1.102-.1 1.469-.1.368-.205.668-.5.868-.2.2-.415.399-.6.5a5.741 5.741 0 00-.281.14l-.018.008-.006.003zM10 16.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd" /></svg>
                    <div><strong>Location</strong><span>{{ offer.Location }}</span></div>
                </div>
                {% endif %}
                {% if offer.JobType %}
                <div class="detail-item">
                     <svg viewBox="0 0 20 20"><path d="M5.25 3A2.25 2.25 0 003 5.25v9.5A2.25 2.25 0 005.25 17h9.5A2.25 2.25 0 0017 14.75v-9.5A2.25 2.25 0 0014.75 3h-9.5zM8.5 6a.5.5 0 01.5.5v2a.5.5 0 01-1 0v-2a.5.5 0 01.5-.5zM12 6a.5.5 0 01.5.5v2a.5.5 0 01-1 0v-2a.5.5 0 01.5-.5z" /></svg>
                    <div><strong>Job Type</strong><span>{{ offer.JobType }}</span></div>
                </div>
                {% endif %}
                 {% if offer.NetSalary %}
                <div class="detail-item">
                    <svg viewBox="0 0 20 20"><path d="M10 8a3 3 0 100 6 3 3 0 000-6zM3.465 14.493a1.23 1.23 0 00.41 1.412A9.957 9.957 0 0010 18c2.31 0 4.438-.784 6.131-2.095a1.23 1.23 0 00.41-1.412A9.957 9.957 0 0010 12c-2.31 0-4.438.784-6.131 2.095z" /></svg>
                    <div><strong>Salary</strong><span>{{ offer.NetSalary }} {{ offer.Currency }}</span></div>
                </div>
                {% endif %}
            </div>

            <!-- Content Sections -->
            <div class="content-formatted">
                {% if offer.Description %}<h3>Job Description</h3>{{ offer.Description|safe }}{% endif %}
                {% if offer.Requirements %}<h3>Requirements</h3>{{ offer.Requirements|safe }}{% endif %}
                {% if offer.Benefits_list %}<h3>Benefits</h3><ul class="styled-list">{% for benefit in offer.Benefits_list %}<li>{{ benefit }}</li>{% endfor %}</ul>{% endif %}
                {% if offer.CompanyDescription %}<h3>About {{ offer.CompanyName }}</h3>{{ offer.CompanyDescription|safe }}{% endif %}
            </div>
            
        {% else %}
            <div class="text-center py-10">
                <h2 class="text-xl font-bold text-heading">Job Offer Not Found</h2>
                <p class="mt-2 text-text-muted">This offer may no longer be available.</p>
                <a href="{{ url_for('job_board_bp.job_offers_list') }}" class="mt-6 inline-block rounded-md bg-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-darker">← View Other Job Offers</a>
            </div>
        {% endif %}
    </div>
</div>

<!-- Sticky Apply Bar -->
<div class="sticky-apply-bar">
    <div class="sticky-apply-bar-content">
        <div class="job-info">
            <h4>{{ offer.Title }}</h4>
            <p>{{ offer.CompanyName }} • {{ offer.Location }}</p>
        </div>
        <!-- FIX: Using the classes from your CSS file -->
        {% if current_user.is_authenticated and current_user.role_type == 'Candidate' %}
            <a href="{{ url_for('job_board_bp.apply_to_job', offer_id=offer.OfferID) }}" class="apply-button">Apply Now</a>
        {% else %}
            <a href="{{ url_for('login_bp.login', next=url_for('job_board_bp.apply_to_job', offer_id=offer.OfferID)) }}" class="apply-button">Login to Apply</a>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block footer %}{% endblock footer %}