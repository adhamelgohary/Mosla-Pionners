{# templates/account_manager_portal/portfolio_detailed.html #}
{% extends "account_manager_portal/account_manager_base.html" %}

{% block page_title %}
    Portfolio for {{ manager.FirstName }} {{ manager.LastName }}
{% endblock %}

{% block content %}
<div class="space-y-8">
    {% for company in companies_data %}
    <div class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-200">
        <!-- Company Header (Now a link) -->
        <a href="{{ url_for('.view_single_company', company_id=company.CompanyID) }}" class="block p-6 border-b border-gray-200 hover:bg-gray-50 transition-colors">
            <h3 class="text-xl font-semibold text-indigo-600 hover:text-indigo-700">{{ company.CompanyName }}</h3>
            <p class="text-sm text-gray-500">{{ company.Industry or 'No industry specified' }}</p>
        </a>

        <!-- Job Offers List for this company -->
        <div class="divide-y divide-gray-200">
            {% for offer in company.job_offers %}
            <div class="p-6">
                <div class="w-full flex justify-between items-center text-left">
                    <!-- Offer Title (Now a link) -->
                    <div>
                        <a href="{{ url_for('.view_offer_applicants', offer_id=offer.OfferID) }}" class="font-semibold text-lg text-gray-800 hover:text-indigo-600">{{ offer.Title }}</a>
                        <div class="mt-1">
                            <span class="text-sm px-2 py-0.5 rounded-full {{ 'bg-green-100 text-green-800' if offer.Status == 'Open' else 'bg-yellow-100 text-yellow-800' }}">
                                {{ offer.Status }}
                            </span>
                        </div>
                    </div>
                    <!-- Applicant Count and Link to Offer Page -->
                    <div class="flex items-center gap-4">
                        <div class="text-right">
                           <p class="text-sm font-semibold text-gray-900">{{ offer.NewApplicantCount }}</p>
                           <p class="text-xs text-gray-500">New Applicant(s)</p>
                        </div>
                        <a href="{{ url_for('.view_offer_applicants', offer_id=offer.OfferID) }}" class="inline-block px-4 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700">
                            Review â†’
                        </a>
                    </div>
                </div>
            </div>
            {% else %}
            <p class="text-sm text-gray-500 p-6">No job offers found for this company.</p>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <div class="text-center py-12 bg-white rounded-lg shadow">
        <p class="text-gray-500">No companies are currently assigned to this portfolio.</p>
    </div>
    {% endfor %}
</div>
{% endblock %}