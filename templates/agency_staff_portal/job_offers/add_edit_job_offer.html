{% extends "agency_staff_portal/staff_base.html" %}

{% block staff_title %}{{ title }}{% endblock %}
{% block staff_page_title %}{{ title }}{% endblock %}

{% block staff_content %}
<div class="max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-sm border border-gray-200">
    <form method="POST" action="{% if is_editing_live %}{{ url_for('job_offer_mgmt_bp.edit_live_job_offer', offer_id=offer_id) }}{% else %}{{ url_for('job_offer_mgmt_bp.staff_direct_create_job_offer') }}{% endif %}">
        {% if is_editing_live %}<input type="hidden" name="original_title_hidden" value="{{ original_title_hidden or form_data.get('position-title', '') }}">{% endif %}

        <div class="space-y-8">
            <!-- Section 1: Core Info -->
            <div>
                <h3 class="text-lg font-medium text-gray-900">Core Information</h3>
                <p class="mt-1 text-sm text-gray-500">Essential details about the role and company.</p>
                <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
                    <div class="sm:col-span-3">
                        <label for="company_id" class="block text-sm font-medium text-gray-700">Company <span class="text-red-500">*</span></label>
                        <select id="company_id" name="company_id" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm {{ 'border-red-500' if errors.get('company_id') }}">
                            <option value="">Select Company...</option>
                            {% for company in companies %}<option value="{{ company.CompanyID }}" {% if form_data.get('company_id')|string == company.CompanyID|string %}selected{% endif %}>{{ company.CompanyName }}</option>{% endfor %}
                        </select>
                    </div>
                    <div class="sm:col-span-3">
                        <label for="category_id" class="block text-sm font-medium text-gray-700">Job Category <span class="text-red-500">*</span></label>
                        <select id="category_id" name="category_id" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm {{ 'border-red-500' if errors.get('category_id') }}">
                            <option value="">Select Category...</option>
                             {% for category in categories %}<option value="{{ category.CategoryID }}" {% if form_data.get('category_id')|string == category.CategoryID|string %}selected{% endif %}>{{ category.CategoryName }}</option>{% endfor %}
                        </select>
                    </div>
                    <div class="sm:col-span-6">
                        <label for="position-title" class="block text-sm font-medium text-gray-700">Position / Job Title <span class="text-red-500">*</span></label>
                        <input type="text" id="position-title" name="position-title" value="{{ form_data.get('position-title', '') }}" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm" placeholder="e.g., Senior Customer Service Agent">
                    </div>
                </div>
            </div>

            <!-- Section 2: Requirements -->
            <div class="border-t border-gray-200 pt-8">
                 <h3 class="text-lg font-medium text-gray-900">Candidate Requirements</h3>
                 <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
                    <div class="sm:col-span-2">
                        <label for="required_language" class="block text-sm font-medium text-gray-700">Language</label>
                        <select id="required_language" name="required_language" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm">
                            <option value="english" {% if form_data.get('required_language') == 'english' %}selected{% endif %}>English</option>
                            <option value="german" {% if form_data.get('required_language') == 'german' %}selected{% endif %}>German</option>
                        </select>
                    </div>
                    <div class="sm:col-span-2">
                        <label for="english-level" class="block text-sm font-medium text-gray-700">Level</label>
                        <select id="english-level" name="english-level" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm">
                            <option value="b2" {% if form_data.get('english-level') == 'b2' %}selected{% endif %}>B2</option>
                            <option value="c1" {% if form_data.get('english-level') == 'c1' %}selected{% endif %}>C1</option>
                        </select>
                    </div>
                     <div class="sm:col-span-2">
                        <label for="candidate-count" class="block text-sm font-medium text-gray-700">Candidates Needed</label>
                        <input type="number" id="candidate-count" name="candidate-count" value="{{ form_data.get('candidate-count', '1') }}" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm">
                    </div>
                 </div>
            </div>
            
             <!-- Section 3: Offer Details -->
            <div class="border-t border-gray-200 pt-8">
                 <h3 class="text-lg font-medium text-gray-900">Offer Details</h3>
                 <div class="mt-6 space-y-6">
                    <fieldset>
                        <legend class="text-sm font-medium text-gray-700">Benefits</legend>
                        <div class="mt-4 space-y-4 sm:flex sm:items-center sm:space-y-0 sm:space-x-10">
                            {% set benefits = form_data.get('benefits', []) %}
                            <div class="flex items-center"><input id="benefit-training" name="benefits" type="checkbox" value="paid_training" {% if 'paid_training' in benefits %}checked{% endif %} class="h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500"><label for="benefit-training" class="ml-3 block text-sm text-gray-900">Paid Training</label></div>
                            <div class="flex items-center"><input id="benefit-social" name="benefits" type="checkbox" value="social_insurance" {% if 'social_insurance' in benefits %}checked{% endif %} class="h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500"><label for="benefit-social" class="ml-3 block text-sm text-gray-900">Social Insurance</label></div>
                            <div class="flex items-center"><input id="benefit-medical" name="benefits" type="checkbox" value="medical_insurance" {% if 'medical_insurance' in benefits %}checked{% endif %} class="h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500"><label for="benefit-medical" class="ml-3 block text-sm text-gray-900">Medical Insurance</label></div>
                        </div>
                    </fieldset>
                    <div class="sm:col-span-2">
                        <label for="salary" class="block text-sm font-medium text-gray-700">Salary (Net)</label>
                        <input type="number" step="0.01" id="salary" name="salary" value="{{ form_data.get('salary', '') }}" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm {{ 'border-red-500' if errors.get('salary') }}">
                         {% if errors.get('salary') %}<p class="mt-2 text-sm text-red-600">{{ errors.get('salary') }}</p>{% endif %}
                    </div>
                 </div>
            </div>
        </div>

        <div class="pt-8 border-t border-gray-200 mt-8 flex justify-end gap-3">
            <a href="{{ url_for('job_offer_mgmt_bp.list_all_job_offers') }}" class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</a>
            <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700">{{ action_verb }} Offer</button>
        </div>
    </form>
</div>
{% endblock %}