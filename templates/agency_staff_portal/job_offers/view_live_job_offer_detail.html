{# templates/agency_staff_portal/job_offers/view_live_job_offer_detail.html #}
{% extends "agency_staff_portal/staff_base.html" %}

{% macro detail_item(label, icon) %}
    <div class="py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
        <dt class="text-sm font-medium leading-6 text-text-muted flex items-center gap-2"><i class="bi {{ icon }} text-primary"></i> {{ label }}</dt>
        <dd class="mt-1 text-sm leading-6 text-text sm:col-span-2 sm:mt-0">{{ caller() | safe if caller else 'N/A' }}</dd>
    </div>
{% endmacro %}

{% block staff_content %}
<div class="p-1 md:p-2">
    <header class="mb-6">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
            <div>
                <h1 class="fluid-text-3xl font-bold text-heading">{{ offer.Title }}</h1>
                <p class="mt-1 text-text-muted">For <span class="font-semibold text-text">{{ offer.CompanyName }}</span>.</p>
            </div>
            <a href="{{ url_for('job_offer_mgmt_bp.edit_live_job_offer', offer_id=offer.OfferID) }}" class="btn-primary self-start sm:self-center">Edit Offer</a>
        </div>
    </header>

    <div class="bg-card rounded-lg shadow border border-border overflow-hidden">
        <div class="p-4 sm:p-6">
            <dl class="divide-y divide-border">
                
                <div><h3 class="text-base font-semibold leading-7 text-heading mb-3 pt-2">Core Information</h3>
                    {% call detail_item('Status', 'bi-toggles') %}<span class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium {{ 'bg-success/10 text-success-700' if offer.Status == 'Open' else 'bg-danger/10 text-danger-700' }}">{{ offer.Status }}</span>{% endcall %}
                    {% call detail_item('Salary', 'bi-cash-coin') %}{% if offer.NetSalary is not none %}{{ "EGP {:,.2f}".format(offer.NetSalary) }}{% else %}Not specified{% endif %} <span class="text-text-muted">({{ offer.get('PaymentTerm', 'N/A') }})</span>{% endcall %}
                </div>

                <div><h3 class="text-base font-semibold leading-7 text-heading mb-3 pt-4">Candidate Requirements</h3>
                    {% call detail_item('Max Age', 'bi-person-video3') %}{{ offer.get('MaxAge') }}{% endcall %}
                    {% call detail_item('Gender', 'bi-gender-ambiguous') %}{{ offer.get('Gender') }}{% endcall %}
                    {% call detail_item('Graduation', 'bi-mortarboard-fill') %}<div class="flex flex-wrap gap-2">{% for status in offer.GraduationStatus_list %}<span class="inline-flex items-center rounded-md bg-background px-2 py-1 text-xs font-medium border border-border">{{ status|replace("-", " ")|title }}</span>{% endfor %}</div>{% endcall %}
                    {% call detail_item('Languages', 'bi-translate') %}<div class="flex flex-wrap items-center gap-2">{% for lang in offer.RequiredLanguages_list %}<span class="inline-flex items-center rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary">{{ lang }}</span>{% endfor %}<span class="text-xs text-text-muted">(Level: {{ offer.get('RequiredLevel', 'N/A') }})</span></div>{% endcall %}
                </div>
                
                <div><h3 class="text-base font-semibold leading-7 text-heading mb-3 pt-4">Work & Schedule</h3>
                    {% call detail_item('Location', 'bi-geo-alt-fill') %}{{ offer.get('WorkLocationType')|title if offer.get('WorkLocationType') }}{% endcall %}
                    {% call detail_item('Working Days', 'bi-calendar-week') %}{{ offer.get('WorkingDays') }}{% endcall %}
                    {% call detail_item('Working Hours', 'bi-hourglass-split') %}{{ offer.get('WorkingHours') }}{% endcall %}
                    {% call detail_item('Experience', 'bi-graph-up-arrow') %}<p class="whitespace-pre-wrap">{{ offer.get('ExperienceRequirement', 'N/A') }}</p>{% endcall %}
                </div>
                
                <div><h3 class="text-base font-semibold leading-7 text-heading mb-3 pt-4">Benefits</h3>
                    {% call detail_item('Benefits', 'bi-gem') %}<div class="flex flex-wrap gap-2">{% for benefit in offer.Benefits_list %}<span class="inline-flex items-center rounded-md bg-success/10 px-2 py-1 text-xs font-medium text-success-700">{{ benefit }}</span>{% endfor %}</div>{% endcall %}
                </div>
            </dl>
        </div>
        <div class="bg-background px-4 py-3 sm:px-6 text-right border-t border-border"><a href="{{ url_for('.list_all_job_offers') }}" class="btn-secondary">Back to List</a></div>
    </div>
</div>
{% endblock %}