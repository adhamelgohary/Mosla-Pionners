{% extends 'agency_staff_portal/staff_base.html' %}

{% block staff_title %}{{ title }}{% endblock %}

{% block staff_page_title %}
    <i class="bi bi-speedometer2"></i> {{ title }}
{% endblock %}

{% block staff_content %}
<div class="space-y-8">
    <!-- KPI Section -->
    <div>
        <h3 class="text-base font-semibold leading-6 text-gray-900">Key Performance Indicators</h3>
        <dl class="mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3">
            <!-- Total Open Offers -->
            <div class="relative overflow-hidden rounded-lg bg-white px-4 pb-12 pt-5 shadow sm:px-6 sm:pt-6">
                <dt>
                    <div class="absolute rounded-md bg-primary-500 p-3"><i class="bi bi-briefcase-fill text-white h-6 w-6"></i></div>
                    <p class="ml-16 truncate text-sm font-medium text-gray-500">Total Open Offers</p>
                </dt>
                <dd class="ml-16 flex items-baseline pb-6 sm:pb-7">
                    <p class="text-2xl font-semibold text-gray-900">{{ kpis.total_open_offers }}</p>
                    <div class="absolute inset-x-0 bottom-0 bg-gray-50 px-4 py-4 sm:px-6">
                        <div class="text-sm"><a href="{{ url_for('.list_all_job_offers') }}" class="font-medium text-primary-600 hover:text-primary-500">View all</a></div>
                    </div>
                </dd>
            </div>
            <!-- Total Candidates Needed -->
            <div class="relative overflow-hidden rounded-lg bg-white px-4 pb-12 pt-5 shadow sm:px-6 sm:pt-6">
                <dt>
                    <div class="absolute rounded-md bg-primary-500 p-3"><i class="bi bi-people-fill text-white h-6 w-6"></i></div>
                    <p class="ml-16 truncate text-sm font-medium text-gray-500">Open Positions</p>
                </dt>
                <dd class="ml-16 flex items-baseline pb-6 sm:pb-7">
                    <p class="text-2xl font-semibold text-gray-900">{{ kpis.total_candidates_needed }}</p>
                    <p class="ml-2 flex items-baseline text-sm font-semibold text-gray-500">candidates needed</p>
                    <div class="absolute inset-x-0 bottom-0 bg-gray-50 px-4 py-4 sm:px-6">
                        <div class="text-sm"><a href="{{ url_for('.list_all_job_offers') }}" class="font-medium text-primary-600 hover:text-primary-500">View details</a></div>
                    </div>
                </dd>
            </div>
            <!-- Pending Submissions -->
            <div class="relative overflow-hidden rounded-lg bg-white px-4 pb-12 pt-5 shadow sm:px-6 sm:pt-6">
                <dt>
                    <div class="absolute rounded-md bg-yellow-500 p-3"><i class="bi bi-inbox-fill text-white h-6 w-6"></i></div>
                    <p class="ml-16 truncate text-sm font-medium text-gray-500">Pending Client Submissions</p>
                </dt>
                <dd class="ml-16 flex items-baseline pb-6 sm:pb-7">
                    <p class="text-2xl font-semibold text-gray-900">{{ kpis.pending_submissions }}</p>
                    <div class="absolute inset-x-0 bottom-0 bg-gray-50 px-4 py-4 sm:px-6">
                        <div class="text-sm"><a href="{{ url_for('.list_review_client_submissions') }}" class="font-medium text-primary-600 hover:text-primary-500">Review now</a></div>
                    </div>
                </dd>
            </div>
        </dl>
    </div>

    <!-- Quick Stats Section -->
    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
         <h3 class="text-base font-semibold leading-6 text-gray-900 mb-4">Quick Stats</h3>
         <ul class="divide-y divide-gray-200">
             <li class="py-3 flex justify-between text-sm"><span class="font-medium text-gray-600">New Offers This Month:</span><span class="font-semibold text-gray-800">{{ kpis.new_offers_this_month }}</span></li>
             <li class="py-3 flex justify-between text-sm"><span class="font-medium text-gray-600">Average Time to Fill:</span><span class="font-semibold text-gray-800">{{ kpis.avg_time_to_fill }} days</span></li>
             <li class="py-3 flex justify-between text-sm"><span class="font-medium text-gray-600">Client Submission Approval Rate (90d):</span><span class="font-semibold text-gray-800">{{ kpis.approval_rate }}</span></li>
             <li class="py-3 flex justify-between text-sm"><span class="font-medium text-gray-600">Oldest Open Offer:</span><span class="font-semibold text-gray-800">{{ kpis.age_of_oldest_offer }} days old</span></li>
             {% if kpis.oldest_offer_title != 'No open offers' %}
             <li class="pt-2 text-xs text-gray-500 text-right">{{ kpis.oldest_offer_title }} at {{ kpis.oldest_offer_company }}</li>
             {% endif %}
         </ul>
    </div>
</div>
{% endblock %}